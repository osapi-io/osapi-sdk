openapi: 3.0.0
info:
  title: Agent Management API
  version: 1.0.0
tags:
  - name: Agent_Management_API_agent_operations
    x-displayName: Agent
    description: Operations related to agent discovery and details.
  - name: Audit_Log_API_audit
    x-displayName: Audit
    description: Audit log endpoints for viewing API activity.
  - name: OSAPI_-_A_CRUD_API_for_managing_Linux_systems_info
    x-displayName: Info
    description: Operations related to the info endpoint.
  - name: Health_Check_API_health
    x-displayName: Health
    description: Health check endpoints for liveness, readiness, and detailed status.
  - name: Job_Management_API_job_operations
    x-displayName: Job
    description: Operations related to the job queue.
  - name: Node_Management_API_node_operations
    x-displayName: Node
    description: Operations related to the node endpoint.
  - name: Node_Management_API_node_status
    x-displayName: Node/Status
    description: Operations related to node status endpoint.
  - name: Node_Management_API_network_operations
    x-displayName: Node/Network
    description: Network operations on a target node.
  - name: Node_Management_API_dns_operations
    x-displayName: Node/Network/DNS
    description: DNS configuration operations on a target node.
  - name: Node_Management_API_command_operations
    x-displayName: Node/Command
    description: Command execution on a target node.
paths:
  /agent:
    servers: []
    get:
      summary: List active agents
      description: Discover all active agents in the fleet.
      tags:
        - Agent_Management_API_agent_operations
      security:
        - BearerAuth:
            - agent:read
      responses:
        '200':
          description: List of active agents.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListAgentsResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error discovering agents.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /agent/{hostname}:
    servers: []
    get:
      summary: Get agent details
      description: Get detailed information about a specific agent by hostname.
      operationId: getAgentDetails
      tags:
        - Agent_Management_API_agent_operations
      security:
        - BearerAuth:
            - agent:read
      parameters:
        - name: hostname
          in: path
          required: true
          schema:
            type: string
          description: The hostname of the agent to retrieve.
      responses:
        '200':
          description: Agent details.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentInfo'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving agent details.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /audit:
    servers: []
    get:
      operationId: GetAuditLogs
      summary: List audit log entries
      description: Returns a paginated list of audit log entries, newest first.
      tags:
        - Audit_Log_API_audit
      security:
        - BearerAuth:
            - audit:read
      parameters:
        - name: limit
          in: query
          required: false
          x-oapi-codegen-extra-tags:
            validate: omitempty,min=1,max=100
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
          description: Maximum number of entries to return.
        - name: offset
          in: query
          required: false
          x-oapi-codegen-extra-tags:
            validate: omitempty,min=0
          schema:
            type: integer
            default: 0
            minimum: 0
          description: Number of entries to skip.
      responses:
        '200':
          description: List of audit entries.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListAuditResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /audit/export:
    servers: []
    get:
      operationId: GetAuditExport
      summary: Export all audit log entries
      description: Returns all audit log entries without pagination for export.
      tags:
        - Audit_Log_API_audit
      security:
        - BearerAuth:
            - audit:read
      responses:
        '200':
          description: All audit entries.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListAuditResponse'
        '401':
          description: Unauthorized - API key required.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /audit/{id}:
    servers: []
    get:
      operationId: GetAuditLogByID
      summary: Get a single audit log entry
      description: Returns a single audit log entry by ID.
      tags:
        - Audit_Log_API_audit
      security:
        - BearerAuth:
            - audit:read
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The audit entry ID.
      responses:
        '200':
          description: Audit entry found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuditEntryResponse'
        '401':
          description: Unauthorized - API key required.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Audit entry not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /version:
    servers:
      - url: http://127.0.0.1:8080
        description: Mock API (local).
    get:
      summary: Retrieve the software version
      description: Get the current version of the software running on the system.
      tags:
        - OSAPI_-_A_CRUD_API_for_managing_Linux_systems_info
      responses:
        '400':
          description: A common JSON error response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /health:
    servers: []
    get:
      operationId: GetHealth
      summary: Liveness probe
      description: Returns 200 if the process is alive. No checks performed.
      tags:
        - Health_Check_API_health
      responses:
        '200':
          description: Process is alive.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
  /health/ready:
    servers: []
    get:
      operationId: GetHealthReady
      summary: Readiness probe
      description: Returns 200 when the service is ready to accept traffic.
      tags:
        - Health_Check_API_health
      responses:
        '200':
          description: Service is ready.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReadyResponse'
        '503':
          description: Service is not ready.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReadyResponse'
  /health/status:
    servers: []
    get:
      operationId: GetHealthStatus
      summary: System status and component health
      description: >-
        Returns per-component health status with system metrics. Requires
        authentication.
      tags:
        - Health_Check_API_health
      security:
        - BearerAuth:
            - health:read
      responses:
        '200':
          description: All components healthy.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        '401':
          description: Unauthorized - API key required.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '503':
          description: One or more components unhealthy.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
  /job:
    servers: []
    post:
      summary: Create a new job
      description: Submit a new job to the queue for processing.
      tags:
        - Job_Management_API_job_operations
      security:
        - BearerAuth:
            - job:write
      requestBody:
        description: The job to create.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateJobRequest'
      responses:
        '201':
          description: The job was created successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateJobResponse'
        '400':
          description: Invalid request payload.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error creating job.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    get:
      summary: List jobs
      description: Retrieve jobs, optionally filtered by status.
      tags:
        - Job_Management_API_job_operations
      security:
        - BearerAuth:
            - job:read
      parameters:
        - name: status
          in: query
          required: false
          x-oapi-codegen-extra-tags:
            validate: >-
              omitempty,oneof=submitted processing completed failed
              partial_failure
          schema:
            type: string
            enum:
              - submitted
              - processing
              - completed
              - failed
              - partial_failure
          description: Filter jobs by status.
        - name: limit
          in: query
          required: false
          x-oapi-codegen-extra-tags:
            validate: omitempty,min=0
          schema:
            type: integer
            minimum: 0
            default: 10
          description: Maximum number of jobs to return. Use 0 for no limit.
        - name: offset
          in: query
          required: false
          x-oapi-codegen-extra-tags:
            validate: omitempty,min=0
          schema:
            type: integer
            minimum: 0
            default: 0
          description: Number of jobs to skip for pagination.
      responses:
        '200':
          description: A list of jobs.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListJobsResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error listing jobs.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /job/status:
    servers: []
    get:
      summary: Get queue statistics
      description: Retrieve statistics about the job queue.
      tags:
        - Job_Management_API_job_operations
      security:
        - BearerAuth:
            - job:read
      responses:
        '200':
          description: Queue statistics.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueueStatsResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving queue statistics.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /job/{id}:
    servers: []
    get:
      summary: Get job detail
      description: Retrieve details of a specific job by its ID.
      tags:
        - Job_Management_API_job_operations
      operationId: GetJobByID
      security:
        - BearerAuth:
            - job:read
      parameters:
        - name: id
          in: path
          required: true
          description: UUID of the job to retrieve.
          schema:
            type: string
            format: uuid
            x-oapi-codegen-extra-tags:
              validate: required,uuid
      responses:
        '200':
          description: The job details.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JobDetailResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Job not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving job.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      summary: Delete a job
      description: Delete a specific job by its ID.
      tags:
        - Job_Management_API_job_operations
      operationId: DeleteJobByID
      security:
        - BearerAuth:
            - job:write
      parameters:
        - name: id
          in: path
          required: true
          description: UUID of the job to delete.
          schema:
            type: string
            format: uuid
            x-oapi-codegen-extra-tags:
              validate: required,uuid
      responses:
        '204':
          description: Job deleted successfully. No content returned.
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Job not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error deleting job.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /job/{id}/retry:
    servers: []
    post:
      summary: Retry a job
      description: >-
        Create a new job using the same operation data as an existing job. The
        original job is preserved. Returns the new job ID.
      tags:
        - Job_Management_API_job_operations
      operationId: RetryJobByID
      security:
        - BearerAuth:
            - job:write
      parameters:
        - name: id
          in: path
          required: true
          description: UUID of the job to retry.
          schema:
            type: string
            format: uuid
            x-oapi-codegen-extra-tags:
              validate: required,uuid
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RetryJobRequest'
      responses:
        '201':
          description: The retry job was created successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateJobResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Job not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrying job.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}:
    servers: []
    get:
      summary: Retrieve node status
      description: >
        Get the current status of the node including hostname, uptime, load
        averages, memory, and disk usage.
      tags:
        - Node_Management_API_node_status
      operationId: GetNodeStatus
      security:
        - BearerAuth:
            - node:read
      parameters:
        - $ref: '#/components/parameters/Hostname'
      responses:
        '200':
          description: |
            A JSON object containing the node's status information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeStatusCollectionResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving node status.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/hostname:
    servers: []
    get:
      summary: Retrieve node hostname
      description: Get the current hostname and labels of the node.
      tags:
        - Node_Management_API_node_operations
      operationId: GetNodeHostname
      security:
        - BearerAuth:
            - node:read
      parameters:
        - $ref: '#/components/parameters/Hostname'
      responses:
        '200':
          description: A JSON object containing the node's hostname.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HostnameCollectionResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving hostname.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/disk:
    servers: []
    get:
      summary: Retrieve disk usage
      description: Get disk usage information for the target node.
      tags:
        - Node_Management_API_node_operations
      operationId: GetNodeDisk
      security:
        - BearerAuth:
            - node:read
      parameters:
        - $ref: '#/components/parameters/Hostname'
      responses:
        '200':
          description: Disk usage information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DiskCollectionResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving disk usage.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/memory:
    servers: []
    get:
      summary: Retrieve memory stats
      description: Get memory usage information for the target node.
      tags:
        - Node_Management_API_node_operations
      operationId: GetNodeMemory
      security:
        - BearerAuth:
            - node:read
      parameters:
        - $ref: '#/components/parameters/Hostname'
      responses:
        '200':
          description: Memory usage information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemoryCollectionResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving memory stats.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/load:
    servers: []
    get:
      summary: Retrieve load averages
      description: Get load average information for the target node.
      tags:
        - Node_Management_API_node_operations
      operationId: GetNodeLoad
      security:
        - BearerAuth:
            - node:read
      parameters:
        - $ref: '#/components/parameters/Hostname'
      responses:
        '200':
          description: Load average information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoadCollectionResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving load averages.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/os:
    servers: []
    get:
      summary: Retrieve OS info
      description: Get operating system information for the target node.
      tags:
        - Node_Management_API_node_operations
      operationId: GetNodeOS
      security:
        - BearerAuth:
            - node:read
      parameters:
        - $ref: '#/components/parameters/Hostname'
      responses:
        '200':
          description: Operating system information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OSInfoCollectionResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving OS info.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/uptime:
    servers: []
    get:
      summary: Retrieve uptime
      description: Get uptime information for the target node.
      tags:
        - Node_Management_API_node_operations
      operationId: GetNodeUptime
      security:
        - BearerAuth:
            - node:read
      parameters:
        - $ref: '#/components/parameters/Hostname'
      responses:
        '200':
          description: Uptime information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UptimeCollectionResponse'
        '400':
          description: Invalid request parameters.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving uptime.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/network/ping:
    servers: []
    post:
      summary: Ping a remote server
      description: |
        Send a ping to a remote server to verify network connectivity.
      tags:
        - Node_Management_API_network_operations
      operationId: PostNodeNetworkPing
      security:
        - BearerAuth:
            - network:write
      parameters:
        - $ref: '#/components/parameters/Hostname'
      requestBody:
        description: The server to ping.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                address:
                  type: string
                  description: >
                    The IP address of the server to ping. Supports both IPv4 and
                    IPv6.
                  example: 8.8.8.8
                  x-oapi-codegen-extra-tags:
                    validate: required,ip
              required:
                - address
      responses:
        '200':
          description: Successful ping response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PingCollectionResponse'
        '400':
          description: Invalid request payload.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error performing the ping operation.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/network/dns/{interfaceName}:
    servers: []
    get:
      summary: List DNS servers
      description: >
        Retrieve the list of currently configured DNS servers for a specific
        network interface.
      tags:
        - Node_Management_API_dns_operations
      operationId: GetNodeNetworkDNSByInterface
      security:
        - BearerAuth:
            - network:read
      parameters:
        - $ref: '#/components/parameters/Hostname'
        - name: interfaceName
          in: path
          required: true
          x-oapi-codegen-extra-tags:
            validate: required,alphanum
          schema:
            type: string
          description: >
            The name of the network interface to retrieve DNS configuration for.
            Must only contain letters and numbers.
      responses:
        '200':
          description: List of DNS servers.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DNSConfigCollectionResponse'
        '400':
          description: Invalid interface name provided.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error retrieving DNS servers.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/network/dns:
    servers: []
    put:
      summary: Update DNS servers
      description: Update the system's DNS server configuration.
      tags:
        - Node_Management_API_dns_operations
      operationId: PutNodeNetworkDNS
      security:
        - BearerAuth:
            - network:write
      parameters:
        - $ref: '#/components/parameters/Hostname'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DNSConfigUpdateRequest'
      responses:
        '202':
          description: DNS servers update successfully accepted.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DNSUpdateCollectionResponse'
        '400':
          description: Invalid input.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error updating DNS servers.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/command/exec:
    servers: []
    post:
      summary: Execute a command
      description: >
        Execute a command directly without a shell. This is the safer option as
        it does not interpret shell metacharacters.
      tags:
        - Node_Management_API_command_operations
      operationId: PostNodeCommandExec
      security:
        - BearerAuth:
            - command:execute
      parameters:
        - $ref: '#/components/parameters/Hostname'
      requestBody:
        description: The command to execute.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommandExecRequest'
      responses:
        '202':
          description: Command execution accepted.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResultCollectionResponse'
        '400':
          description: Invalid request payload.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error executing command.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /node/{hostname}/command/shell:
    servers: []
    post:
      summary: Execute a shell command
      description: >
        Execute a command through /bin/sh -c. Supports shell features like
        pipes, redirects, and variable expansion.
      tags:
        - Node_Management_API_command_operations
      operationId: PostNodeCommandShell
      security:
        - BearerAuth:
            - command:execute
      parameters:
        - $ref: '#/components/parameters/Hostname'
      requestBody:
        description: The shell command to execute.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommandShellRequest'
      responses:
        '202':
          description: Shell command execution accepted.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommandResultCollectionResponse'
        '400':
          description: Invalid request payload.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - API key required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Error executing shell command.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: A description of the error that occurred.
          example: Failed to retrieve status.
        details:
          type: string
          description: Additional details about the error.
          example: Failed due to network timeout.
        code:
          type: integer
          description: The error code.
          example: 500
    ListAgentsResponse:
      type: object
      properties:
        agents:
          type: array
          items:
            $ref: '#/components/schemas/AgentInfo'
        total:
          type: integer
          description: Total number of active agents.
      required:
        - agents
        - total
    AgentInfo:
      type: object
      properties:
        hostname:
          type: string
          description: The hostname of the agent.
        status:
          type: string
          enum:
            - Ready
            - NotReady
          description: The current status of the agent.
        labels:
          type: object
          additionalProperties:
            type: string
          description: Key-value labels configured on the agent.
        registered_at:
          type: string
          format: date-time
          description: When the agent last refreshed its heartbeat.
        started_at:
          type: string
          format: date-time
          description: When the agent process started.
        os_info:
          $ref: '#/components/schemas/OSInfoResponse'
        uptime:
          type: string
          description: The system uptime.
        load_average:
          $ref: '#/components/schemas/LoadAverageResponse'
        memory:
          $ref: '#/components/schemas/MemoryResponse'
      required:
        - hostname
        - status
    LoadAverageResponse:
      type: object
      description: The system load averages for 1, 5, and 15 minutes.
      properties:
        1min:
          type: number
          description: Load average for the last 1 minute.
          example: 0.32
        5min:
          type: number
          description: Load average for the last 5 minutes.
          example: 0.28
        15min:
          type: number
          description: Load average for the last 15 minutes.
          example: 0.25
      required:
        - 1min
        - 5min
        - 15min
    MemoryResponse:
      type: object
      description: Memory usage information.
      properties:
        total:
          type: integer
          description: Total memory in bytes.
          example: 8388608
        free:
          type: integer
          description: Free memory in bytes.
          example: 2097152
        used:
          type: integer
          description: Used memory in bytes.
          example: 4194304
      required:
        - total
        - free
        - used
    OSInfoResponse:
      type: object
      description: Operating system information.
      properties:
        distribution:
          type: string
          description: The name of the Linux distribution.
          example: Ubuntu
        version:
          type: string
          description: The version of the Linux distribution.
          example: '20.04'
      required:
        - distribution
        - version
    AuditEntry:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the audit entry.
          example: 550e8400-e29b-41d4-a716-446655440000
        timestamp:
          type: string
          format: date-time
          description: When the request was processed.
          example: '2026-02-21T10:30:00Z'
        user:
          type: string
          description: Authenticated user (JWT subject).
          example: ops@example.com
        roles:
          type: array
          items:
            type: string
          description: Roles from the JWT token.
          example:
            - admin
        method:
          type: string
          description: HTTP method.
          example: GET
        path:
          type: string
          description: Request URL path.
          example: /node/hostname
        operation_id:
          type: string
          description: OpenAPI operation ID.
          example: GetNodeHostname
        source_ip:
          type: string
          description: Client IP address.
          example: 192.168.1.100
        response_code:
          type: integer
          description: HTTP response status code.
          example: 200
        duration_ms:
          type: integer
          format: int64
          description: Request duration in milliseconds.
          example: 42
      required:
        - id
        - timestamp
        - user
        - roles
        - method
        - path
        - source_ip
        - response_code
        - duration_ms
    AuditEntryResponse:
      type: object
      properties:
        entry:
          $ref: '#/components/schemas/AuditEntry'
      required:
        - entry
    ListAuditResponse:
      type: object
      properties:
        total_items:
          type: integer
          description: Total number of audit entries.
          example: 150
        items:
          type: array
          items:
            $ref: '#/components/schemas/AuditEntry'
          description: The audit entries for this page.
      required:
        - total_items
        - items
    HealthResponse:
      type: object
      properties:
        status:
          type: string
          description: Health status.
          example: ok
      required:
        - status
    ReadyResponse:
      type: object
      properties:
        status:
          type: string
          description: Readiness status.
          example: ready
        error:
          type: string
          description: Error message when not ready.
      required:
        - status
    ComponentHealth:
      type: object
      properties:
        status:
          type: string
          description: Component health status.
          example: ok
        error:
          type: string
          description: Error message when component is unhealthy.
      required:
        - status
    NATSInfo:
      type: object
      properties:
        url:
          type: string
          description: Connected NATS server URL.
          example: nats://localhost:4222
        version:
          type: string
          description: NATS server version.
          example: 2.10.0
      required:
        - url
        - version
    StreamInfo:
      type: object
      properties:
        name:
          type: string
          description: Stream name.
          example: JOBS
        messages:
          type: integer
          description: Number of messages in the stream.
          example: 42
        bytes:
          type: integer
          description: Total bytes in the stream.
          example: 1024
        consumers:
          type: integer
          description: Number of consumers on the stream.
          example: 1
      required:
        - name
        - messages
        - bytes
        - consumers
    KVBucketInfo:
      type: object
      properties:
        name:
          type: string
          description: KV bucket name.
          example: job-queue
        keys:
          type: integer
          description: Number of keys in the bucket.
          example: 10
        bytes:
          type: integer
          description: Total bytes in the bucket.
          example: 2048
      required:
        - name
        - keys
        - bytes
    JobStats:
      type: object
      properties:
        total:
          type: integer
          description: Total number of jobs.
          example: 100
        unprocessed:
          type: integer
          description: Number of unprocessed jobs.
          example: 5
        processing:
          type: integer
          description: Number of jobs currently processing.
          example: 2
        completed:
          type: integer
          description: Number of completed jobs.
          example: 90
        failed:
          type: integer
          description: Number of failed jobs.
          example: 3
        dlq:
          type: integer
          description: Number of jobs in the dead letter queue.
          example: 0
      required:
        - total
        - unprocessed
        - processing
        - completed
        - failed
        - dlq
    AgentStats:
      type: object
      properties:
        total:
          type: integer
          description: Total number of registered agents.
          example: 5
        ready:
          type: integer
          description: Number of agents with Ready status.
          example: 5
        agents:
          type: array
          items:
            $ref: '#/components/schemas/AgentDetail'
          description: Per-agent registration details.
      required:
        - total
        - ready
    AgentDetail:
      type: object
      properties:
        hostname:
          type: string
          description: Agent hostname.
          example: web-01
        labels:
          type: string
          description: Formatted label string.
          example: group=web.prod
        registered:
          type: string
          description: Time since last heartbeat registration.
          example: 15s ago
      required:
        - hostname
        - registered
    ConsumerStats:
      type: object
      properties:
        total:
          type: integer
          description: Total number of JetStream consumers.
          example: 2
        consumers:
          type: array
          items:
            $ref: '#/components/schemas/ConsumerDetail'
          description: Per-consumer details.
      required:
        - total
    ConsumerDetail:
      type: object
      properties:
        name:
          type: string
          description: Consumer name.
          example: query_any_web_01
        pending:
          type: integer
          description: Messages not yet delivered.
          example: 0
        ack_pending:
          type: integer
          description: Messages delivered but not yet acknowledged.
          example: 3
        redelivered:
          type: integer
          description: Messages redelivered and not yet acknowledged.
          example: 0
      required:
        - name
        - pending
        - ack_pending
        - redelivered
    StatusResponse:
      type: object
      properties:
        status:
          type: string
          description: Overall health status.
          example: ok
        components:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/ComponentHealth'
          description: Per-component health status.
        version:
          type: string
          description: Application version.
          example: 0.1.0
        uptime:
          type: string
          description: Time since server started.
          example: 2h30m
        nats:
          $ref: '#/components/schemas/NATSInfo'
        streams:
          type: array
          items:
            $ref: '#/components/schemas/StreamInfo'
          description: JetStream stream statistics.
        kv_buckets:
          type: array
          items:
            $ref: '#/components/schemas/KVBucketInfo'
          description: KV bucket statistics.
        jobs:
          $ref: '#/components/schemas/JobStats'
        agents:
          $ref: '#/components/schemas/AgentStats'
        consumers:
          $ref: '#/components/schemas/ConsumerStats'
      required:
        - status
        - components
        - version
        - uptime
    CreateJobRequest:
      type: object
      properties:
        operation:
          type: object
          description: The operation to perform, as a JSON object.
          additionalProperties: true
          x-oapi-codegen-extra-tags:
            validate: required
        target_hostname:
          type: string
          description: The target hostname for routing (_any, _all, or specific hostname).
          example: _any
          x-oapi-codegen-extra-tags:
            validate: required,min=1
      required:
        - operation
        - target_hostname
    CreateJobResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: Unique identifier for the created job.
          example: 550e8400-e29b-41d4-a716-446655440000
        status:
          type: string
          description: Initial status of the job.
          example: unprocessed
        revision:
          type: integer
          format: int64
          description: The KV revision number.
          example: 1
        timestamp:
          type: string
          description: Creation timestamp.
          example: '2025-06-14T10:00:00Z'
      required:
        - job_id
        - status
    RetryJobRequest:
      type: object
      properties:
        target_hostname:
          type: string
          description: >-
            Override target hostname for the retried job. Defaults to _any if
            not specified.
          example: _any
          x-oapi-codegen-extra-tags:
            validate: omitempty,min=1
    ListJobsResponse:
      type: object
      properties:
        total_items:
          type: integer
          description: Total number of jobs matching the filter.
          example: 42
        items:
          type: array
          items:
            $ref: '#/components/schemas/JobDetailResponse'
    JobDetailResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier of the job.
        status:
          type: string
          description: Current status of the job.
        created:
          type: string
          description: Creation timestamp.
        operation:
          type: object
          description: The operation data.
          additionalProperties: true
        result:
          description: The result data if completed.
        error:
          type: string
          description: Error message if failed.
        hostname:
          type: string
          description: Agent hostname that processed the job.
        updated_at:
          type: string
          description: Last update timestamp.
        responses:
          type: object
          description: Per-agent response data for broadcast jobs.
          additionalProperties:
            type: object
            properties:
              status:
                type: string
              data:
                description: Agent result data.
              error:
                type: string
              hostname:
                type: string
        agent_states:
          type: object
          description: Per-agent processing state for broadcast jobs.
          additionalProperties:
            type: object
            properties:
              status:
                type: string
              error:
                type: string
              duration:
                type: string
        timeline:
          type: array
          description: Chronological sequence of job lifecycle events.
          items:
            type: object
            properties:
              timestamp:
                type: string
                description: ISO 8601 timestamp of the event.
              event:
                type: string
                description: >-
                  Event type (submitted, acknowledged, started, completed,
                  failed, retried).
              hostname:
                type: string
                description: Agent or source that generated the event.
              message:
                type: string
                description: Human-readable description of the event.
              error:
                type: string
                description: Error details if applicable.
    QueueStatsResponse:
      type: object
      properties:
        total_jobs:
          type: integer
          description: Total number of jobs in the queue.
          example: 42
        status_counts:
          type: object
          additionalProperties:
            type: integer
          description: Count of jobs by status.
        operation_counts:
          type: object
          additionalProperties:
            type: integer
          description: Count of jobs by operation type.
        dlq_count:
          type: integer
          description: Number of jobs in the dead letter queue.
    DiskResponse:
      type: object
      description: Local disk usage information.
      properties:
        name:
          type: string
          description: Disk identifier, e.g., "/dev/sda1".
          example: /dev/sda1
        total:
          type: integer
          description: Total disk space in bytes.
          example: 500000000000
        used:
          type: integer
          description: Used disk space in bytes.
          example: 250000000000
        free:
          type: integer
          description: Free disk space in bytes.
          example: 250000000000
      required:
        - name
        - total
        - used
        - free
    DisksResponse:
      type: array
      description: List of local disk usage information.
      items:
        $ref: '#/components/schemas/DiskResponse'
    UptimeResponse:
      type: object
      description: System uptime information.
      properties:
        hostname:
          type: string
          description: The hostname of the agent.
        uptime:
          type: string
          description: The uptime of the system.
          example: 0 days, 4 hours, 1 minute
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    NodeStatusResponse:
      type: object
      properties:
        hostname:
          type: string
          description: The hostname of the system.
          example: my-linux-server
        uptime:
          type: string
          description: The uptime of the system.
          example: 0 days, 4 hours, 1 minute
        load_average:
          $ref: '#/components/schemas/LoadAverageResponse'
        memory:
          $ref: '#/components/schemas/MemoryResponse'
        disks:
          $ref: '#/components/schemas/DisksResponse'
        os_info:
          $ref: '#/components/schemas/OSInfoResponse'
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    HostnameResponse:
      type: object
      description: The hostname of the system.
      properties:
        hostname:
          type: string
          description: The system's hostname.
          example: my-linux-server
        labels:
          type: object
          additionalProperties:
            type: string
          description: Key-value labels configured on the agent.
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    DiskResultItem:
      type: object
      properties:
        hostname:
          type: string
          description: The hostname of the agent.
        disks:
          $ref: '#/components/schemas/DisksResponse'
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    MemoryResultItem:
      type: object
      properties:
        hostname:
          type: string
          description: The hostname of the agent.
        memory:
          $ref: '#/components/schemas/MemoryResponse'
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    LoadResultItem:
      type: object
      properties:
        hostname:
          type: string
          description: The hostname of the agent.
        load_average:
          $ref: '#/components/schemas/LoadAverageResponse'
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    OSInfoResultItem:
      type: object
      properties:
        hostname:
          type: string
          description: The hostname of the agent.
        os_info:
          $ref: '#/components/schemas/OSInfoResponse'
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    NodeStatusCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/NodeStatusResponse'
      required:
        - results
    HostnameCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/HostnameResponse'
      required:
        - results
    DiskCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/DiskResultItem'
      required:
        - results
    MemoryCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/MemoryResultItem'
      required:
        - results
    LoadCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/LoadResultItem'
      required:
        - results
    OSInfoCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/OSInfoResultItem'
      required:
        - results
    UptimeCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/UptimeResponse'
      required:
        - results
    PingResponse:
      type: object
      properties:
        hostname:
          type: string
          description: The hostname of the agent that executed the ping.
        packets_sent:
          type: integer
          description: Number of packets sent.
          example: 4
        packets_received:
          type: integer
          description: Number of packets received.
          example: 4
        packet_loss:
          type: number
          format: double
          description: Percentage of packet loss.
          example: 0
        min_rtt:
          type: string
          description: |
            Minimum round-trip time in Go time.Duration format.
          example: 14.637103ms
        avg_rtt:
          type: string
          description: |
            Average round-trip time in Go time.Duration format.
          example: 18.647498ms
        max_rtt:
          type: string
          description: |
            Maximum round-trip time in Go time.Duration format.
          example: 24.309240ms
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    PingCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/PingResponse'
      required:
        - results
    DNSConfigResponse:
      type: object
      properties:
        hostname:
          type: string
          description: The hostname of the agent that served this config.
        servers:
          type: array
          description: List of configured DNS servers.
          items:
            type: string
            description: IPv4 or IPv6 address of the DNS server.
        search_domains:
          type: array
          description: List of search domains.
          items:
            type: string
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    DNSConfigCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/DNSConfigResponse'
      required:
        - results
    DNSUpdateResultItem:
      type: object
      properties:
        hostname:
          type: string
        status:
          type: string
          enum:
            - ok
            - failed
        changed:
          type: boolean
          description: Whether the DNS configuration was actually modified.
        error:
          type: string
      required:
        - hostname
        - status
    DNSUpdateCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/DNSUpdateResultItem'
      required:
        - results
    DNSConfigUpdateRequest:
      type: object
      properties:
        servers:
          type: array
          x-oapi-codegen-extra-tags:
            validate: required_without=SearchDomains,omitempty,dive,ip,min=1
          description: New list of DNS servers to configure.
          items:
            type: string
            description: IPv4 or IPv6 address of the DNS server.
        search_domains:
          type: array
          x-oapi-codegen-extra-tags:
            validate: required_without=Servers,omitempty,dive,hostname,min=1
          description: New list of search domains to configure.
          items:
            type: string
        interface_name:
          type: string
          x-oapi-codegen-extra-tags:
            validate: required,alphanum
          description: >
            The name of the network interface to apply DNS configuration to.
            Must only contain letters and numbers.
      required:
        - interface_name
    CommandExecRequest:
      type: object
      properties:
        command:
          type: string
          description: The executable name or path.
          example: ls
          x-oapi-codegen-extra-tags:
            validate: required,min=1
        args:
          type: array
          description: Command arguments.
          items:
            type: string
          example:
            - '-la'
            - /tmp
        cwd:
          type: string
          description: Working directory for the command.
          example: /tmp
        timeout:
          type: integer
          description: Timeout in seconds (default 30, max 300).
          minimum: 1
          maximum: 300
          default: 30
          x-oapi-codegen-extra-tags:
            validate: omitempty,min=1,max=300
      required:
        - command
    CommandShellRequest:
      type: object
      properties:
        command:
          type: string
          description: The full shell command string.
          example: ls -la /tmp | grep log
          x-oapi-codegen-extra-tags:
            validate: required,min=1
        cwd:
          type: string
          description: Working directory for the command.
          example: /tmp
        timeout:
          type: integer
          description: Timeout in seconds (default 30, max 300).
          minimum: 1
          maximum: 300
          default: 30
          x-oapi-codegen-extra-tags:
            validate: omitempty,min=1,max=300
      required:
        - command
    CommandResultItem:
      type: object
      properties:
        hostname:
          type: string
          description: The hostname of the agent that executed the command.
        stdout:
          type: string
          description: Standard output of the command.
        stderr:
          type: string
          description: Standard error output of the command.
        exit_code:
          type: integer
          description: Exit code of the command.
        duration_ms:
          type: integer
          format: int64
          description: Execution time in milliseconds.
        changed:
          type: boolean
          description: Whether the command modified system state.
        error:
          type: string
          description: Error message if the agent failed.
      required:
        - hostname
    CommandResultCollectionResponse:
      type: object
      properties:
        job_id:
          type: string
          format: uuid
          description: The job ID used to process this request.
          example: 550e8400-e29b-41d4-a716-446655440000
        results:
          type: array
          items:
            $ref: '#/components/schemas/CommandResultItem'
      required:
        - results
  parameters:
    Hostname:
      name: hostname
      in: path
      required: true
      description: >
        Target agent hostname, reserved routing value (_any, _all), or label
        selector (key:value).
      x-oapi-codegen-extra-tags:
        validate: required,min=1,valid_target
      schema:
        type: string
        minLength: 1
x-tagGroups:
  - name: Agent Management API
    tags:
      - Agent_Management_API_agent_operations
  - name: Audit Log API
    tags:
      - Audit_Log_API_audit
  - name: OSAPI - A CRUD API for managing Linux systems
    tags:
      - OSAPI_-_A_CRUD_API_for_managing_Linux_systems_info
  - name: Health Check API
    tags:
      - Health_Check_API_health
  - name: Job Management API
    tags:
      - Job_Management_API_job_operations
  - name: Node Management API
    tags:
      - Node_Management_API_node_operations
      - Node_Management_API_node_status
      - Node_Management_API_network_operations
      - Node_Management_API_dns_operations
      - Node_Management_API_command_operations
